#!/bin/bash

#Install nmap dependency
#sudo apt install nmap -y

#Run simple nmap to check for live host between ip range 0-100 on 192.168.0.x
#nmap -sn 192.168.0.1-200 > live-hosts.txt

#Could not scan a sisters laptop, possibly because firewall filtering. Bypassed using -PP flag for nmap
#-PP: nmap will send ICMP timestamp request (type 13) and expects ICMP timestamp replies (type 14).
#nmap -sP -PP 192.168.0.23
#added -PP flag for better network host discovery
LIVEHOSTS=0;

PS3='Please enter your choice (exit: 4): '
options=("Scan Network" "Show Live Hosts" "Scan Live-Host Ports" "Quit")
select opt in "${options[@]}"
do
    case $opt in
        "Scan Network")
	    printf "Starting network scan....\n"
	    nmap -sP -PP 192.168.0.1-200 > live-hosts-full.txt && cat live-hosts-full.txt | grep report | awk '{print $(NF)}' | sort -V > live-hosts.txt
	    LIVEHOSTS=$(wc -l < live-hosts.txt)
	    printf "Network scan done. Found $LIVEHOSTS live hosts.\n\n"
	    ;;
	"Show Live Hosts")
	    printf "\n********** ($LIVEHOSTS) Live Hosts **********\n"
	    cat live-hosts.txt
	    printf "********** End of list **********\n\n"
	    ;;
	"Scan Live-Host Ports")
	    printf "Scanning ports of live hosts...\n"
	    printf "Generating port data doc...\n"
	    printf "Done\n"
	    ;;
	"Quit")
	    echo "Goodbye."
	    break
	    ;;
	*) echo "invalid option $REPLY";;
    esac
done

